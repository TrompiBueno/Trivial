<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Trivial de Física de Química</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700;900&family=Crimson+Pro:ital,wght@0,400;0,600;1,400&display=swap" rel="stylesheet">
    <style id="app-style">
      :root {
        --color-parchment: #f4e9d5;
        --color-parchment-dark: #e8d7b6;
        --color-brown-light: #c9ad88;
        --color-brown: #9e7e4e;
        --color-brown-dark: #705636;
        --color-gold: #d4af37;
        --color-gold-dark: #b08d24;
        --color-green: #4caf50;
        --color-red: #f44336;
      }
      
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
      
      body {
        font-family: 'Crimson Pro', serif;
        background-color: #4e3925;
        background-image: url('https://cdn.pixabay.com/photo/2015/12/03/08/50/paper-1074131_1280.jpg');
        background-size: cover;
        background-position: center;
        background-attachment: fixed;
        color: var(--color-brown-dark);
        min-height: 100vh;
        overflow-x: hidden;
      }
      
      h1, h2, h3 {
        font-family: 'Cinzel', serif;
        color: var(--color-brown-dark);
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
      }
      
      .parchment {
        background-color: var(--color-parchment);
        background-image: url('https://cdn.pixabay.com/photo/2019/03/03/20/22/background-4033032_1280.jpg');
        background-size: cover;
        background-position: center;
        border: 12px solid transparent;
        border-image: url('https://cdn.pixabay.com/photo/2017/01/31/17/10/frame-2025672_1280.png') 30 round;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        padding: 30px;
        border-radius: 8px;
        position: relative;
      }
      
      .btn {
        font-family: 'Cinzel', serif;
        background: linear-gradient(135deg, var(--color-gold), var(--color-gold-dark));
        color: #3a2512;
        border: 2px solid #8b6b2f;
        border-radius: 6px;
        padding: 10px 20px;
        font-size: 1.1rem;
        font-weight: bold;
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        text-shadow: 0 1px 2px rgba(255, 255, 255, 0.2);
        margin: 5px;
      }
      
      .btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
      }
      
      .btn:active {
        transform: translateY(1px);
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
      }
      
      .btn-primary {
        background: linear-gradient(135deg, var(--color-gold), var(--color-gold-dark));
        color: #3a2512;
      }
      
      .btn-secondary {
        background: linear-gradient(135deg, var(--color-brown-light), var(--color-brown));
        color: #fff;
      }
      
      .btn-danger {
        background: linear-gradient(135deg, var(--color-red), darkred);
        color: white;
      }
      
      /* Inicio */
      #inicio {
        text-align: center;
        max-width: 800px;
        margin: 20px auto;
      }
      
      #inicio h1 {
        font-size: 3.5rem;
        margin-bottom: 20px;
        color: var(--color-brown-dark);
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
      }
      
      #equipos-setup {
        margin-top: 30px;
      }
      
      .team-input-container {
        margin-bottom: 15px;
        display: flex;
        align-items: center;
        justify-content: center;
      }
      
      .team-input-container input {
        font-family: 'Crimson Pro', serif;
        font-size: 1.2rem;
        padding: 10px 15px;
        border: 2px solid var(--color-brown);
        border-radius: 6px;
        background-color: rgba(255, 255, 255, 0.6);
        width: 70%;
        max-width: 400px;
      }
      
      /* Tablero */
      #tablero {
        display: none;
      }
      
      .teams-board {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
        margin-bottom: 30px;
        max-height: 450px;
        overflow-y: auto;
      }
      
      .team-card {
        background-color: rgba(255, 255, 255, 0.5);
        border: 3px solid var(--color-brown);
        border-radius: 8px;
        padding: 15px;
        text-align: center;
        transition: all 0.3s ease;
      }
      
      .team-card.active {
        border: 3px solid var(--color-gold);
        box-shadow: 0 0 20px var(--color-gold);
        transform: scale(1.05);
        background-image: url('https://cdn.pixabay.com/photo/2012/12/24/08/39/paper-72989_1280.jpg');
      }
      
      .team-name {
        font-size: 1.5rem;
        font-weight: bold;
        margin-bottom: 10px;
      }
      
      .team-score {
        font-size: 2.5rem;
        font-weight: bold;
        color: var(--color-brown-dark);
      }
      
      #dado-container {
        text-align: center;
        margin: 30px auto;
        perspective: 800px;
      }
      
      #dado {
        width: 120px;
        height: 120px;
        cursor: pointer;
        margin: 0 auto;
        perspective: 800px;
        transform-style: preserve-3d;
      }

      .cube {
        width: 100%;
        height: 100%;
        position: relative;
        transform-style: preserve-3d;
        transition: transform 1.5s ease;
      }

      .face {
        position: absolute;
        width: 100%;
        height: 100%;
        border-radius: 10px;
        border: 2px solid var(--color-brown);
        background-color: var(--color-parchment);
        background-image: url('https://cdn.pixabay.com/photo/2019/03/03/20/22/background-4033032_1280.jpg');
        background-size: cover;
        font-family: 'Cinzel', serif;
        font-size: 48px;
        font-weight: bold;
        display: flex;
        justify-content: center;
        align-items: center;
        box-shadow: inset 0 0 10px rgba(0,0,0,0.2);
      }

      .front { transform: rotateY(0deg) translateZ(60px); }
      .back { transform: rotateY(180deg) translateZ(60px); }
      .right { transform: rotateY(90deg) translateZ(60px); }
      .left { transform: rotateY(-90deg) translateZ(60px); }
      .top { transform: rotateX(90deg) translateZ(60px); }
      .bottom { transform: rotateX(-90deg) translateZ(60px); }

      #dado-resultado {
        margin-top: 20px;
        font-size: 1.8rem;
        font-weight: bold;
        min-height: 2rem;
        transition: all 0.3s ease;
      }
      
      /* Pregunta */
      #pregunta-container {
        display: none;
        margin-top: 20px;
        text-align: center;
        background-image: url('https://cdn.pixabay.com/photo/2017/06/21/21/30/texture-2428461_1280.jpg');
        padding: 40px;
        border-radius: 10px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
        max-width: 800px;
        margin: 20px auto;
        transform: scale(0.9);
        opacity: 0;
        transition: all 0.5s ease;
        position: relative;
      }
      
      #pregunta-container.show {
        transform: scale(1);
        opacity: 1;
      }
      
      #pregunta-texto {
        font-size: 1.5rem;
        margin-bottom: 30px;
        line-height: 1.6;
      }
      
      #respuestas-container {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 15px;
      }
      
      .respuesta-btn {
        background-color: rgba(244, 233, 213, 0.7);
        border: 2px solid var(--color-brown);
        border-radius: 6px;
        padding: 15px;
        font-family: 'Crimson Pro', serif;
        font-size: 1.2rem;
        cursor: pointer;
        transition: all 0.3s ease;
        text-align: left;
      }
      
      .respuesta-btn:hover {
        background-color: rgba(244, 233, 213, 0.9);
        transform: translateY(-3px);
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
      }
      
      /* Modal de Resultado */
      #resultado-modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: rgba(0, 0, 0, 0.7);
        z-index: 1000;
        justify-content: center;
        align-items: center;
      }
      
      .modal-content {
        background-image: url('https://cdn.pixabay.com/photo/2019/03/03/20/22/background-4033032_1280.jpg');
        background-size: cover;
        border: 10px solid transparent;
        border-image: url('https://cdn.pixabay.com/photo/2017/01/31/17/10/frame-2025672_1280.png') 30 round;
        border-radius: 10px;
        padding: 30px;
        max-width: 600px;
        width: 90%;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        text-align: center;
      }
      
      #resultado-titulo {
        font-size: 2.5rem;
        margin-bottom: 20px;
      }
      
      .resultado-correcto {
        color: var(--color-green);
      }
      
      .resultado-incorrecto {
        color: var(--color-red);
      }
      
      #respuesta-correcta {
        font-size: 1.3rem;
        margin: 20px 0;
        padding: 15px;
        background-color: rgba(255, 255, 255, 0.3);
        border-radius: 8px;
      }
      
      /* Panel de Profesor */
      #profesor-panel-trigger {
        position: fixed;
        bottom: 30px;
        right: 30px;
        background-color: var(--color-brown-dark);
        color: white;
        border-radius: 50%;
        width: 60px;
        height: 60px;
        display: flex;
        justify-content: center;
        align-items: center;
        font-size: 24px;
        cursor: pointer;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
        z-index: 990;
        transition: all 0.3s ease;
      }
      
      #profesor-panel-trigger:hover {
        transform: scale(1.1);
      }
      
      #profesor-panel {
        position: fixed;
        bottom: -400px;
        right: 30px;
        width: 250px;
        background-image: url('https://cdn.pixabay.com/photo/2019/03/03/20/22/background-4033032_1280.jpg');
        border: 8px solid transparent;
        border-image: url('https://cdn.pixabay.com/photo/2017/01/31/17/10/frame-2025672_1280.png') 30 round;
        border-radius: 10px 10px 0 0;
        padding: 15px;
        box-shadow: 0 -5px 20px rgba(0, 0, 0, 0.4);
        z-index: 980;
        transition: bottom 0.4s ease;
        max-height: 80vh;
        overflow-y: auto;
        display: none;
      }
      
      #profesor-panel.show {
        bottom: 0;
        z-index: 991;
        display: block;
      }
      
      .prof-close-btn {
        position: absolute;
        top: 10px;
        right: 10px;
        background: var(--color-brown-dark);
        color: white;
        border: none;
        border-radius: 50%;
        width: 24px;
        height: 24px;
        display: flex;
        justify-content: center;
        align-items: center;
        font-size: 12px;
        cursor: pointer;
      }
      
      .profesor-team-control {
        margin-bottom: 15px;
        padding: 10px;
        background-color: rgba(255, 255, 255, 0.3);
        border-radius: 6px;
      }
      
      .prof-team-name {
        font-weight: bold;
        margin-bottom: 5px;
      }
      
      .prof-team-buttons {
        display: flex;
        justify-content: space-between;
      }
      
      .prof-btn {
        padding: 5px 10px;
        font-size: 0.9rem;
      }
      
      /* Animaciones adicionales */
      .fade-in {
        animation: fadeIn 0.5s ease forwards;
      }
      
      .slide-in {
        animation: slideIn 0.5s ease forwards;
      }
      
      @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
      }
      
      @keyframes slideIn {
        from { transform: translateY(20px); opacity: 0; }
        to { transform: translateY(0); opacity: 1; }
      }
      
      /* Answer feedback animations */
      @keyframes greenFlash {
        0% { background-color: rgba(255, 255, 255, 0.5); }
        50% { background-color: rgba(76, 175, 80, 0.5); }
        100% { background-color: rgba(255, 255, 255, 0.5); }
      }

      @keyframes redShake {
        0%, 100% { transform: translateX(0); }
        10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
        20%, 40%, 60%, 80% { transform: translateX(5px); }
      }

      .thumbs-up {
        animation: thumbsUp 0.5s ease-in-out;
      }

      @keyframes thumbsUp {
        0% { transform: scale(1); }
        50% { transform: scale(1.2); }
        100% { transform: scale(1); }
      }

      .sparkle {
        position: fixed;
        width: 6px;
        height: 6px;
        border-radius: 50%;
        background-color: var(--color-gold);
        pointer-events: none;
        opacity: 0;
        z-index: 2000;
        animation: sparkle 1.5s ease-in-out forwards;
      }

      @keyframes sparkle {
        0% { transform: translateY(0) scale(0); opacity: 0; }
        50% { opacity: 1; }
        100% { transform: translateY(-100px) scale(0); opacity: 0; }
      }

      #sparkles-container {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
        z-index: 999;
      }
      
      /* Responsive */
      @media (max-width: 768px) {
        #inicio h1 {
          font-size: 2.5rem;
        }
        
        .teams-board {
          grid-template-columns: 1fr;
        }
        
        #respuestas-container {
          grid-template-columns: 1fr;
        }
        
        .modal-content {
          width: 95%;
          padding: 15px;
        }
        
        #profesor-panel {
          width: 90%;
          right: 5%;
        }
      }
      
      #clasificacion-modal .parchment {
        animation: fadeIn 0.8s ease forwards, scaleIn 0.5s ease forwards;
      }
      
      @keyframes scaleIn {
        from { transform: scale(0.8); }
        to { transform: scale(1); }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <!-- Pantalla de inicio -->
      <div id="inicio" class="parchment">
        <h1>Trivial de Física y Química</h1>
        <p>¡Bienvenidos al juego de trivial por equipos! En este juego repasaremos los conceptos claves de estos últimos temas de física y química. ¡Espero que os guste!</p>
        
        <div id="equipos-setup">
          <h2>Configuración de equipos</h2>
          
          <div class="select-container">
            <label for="num-equipos">Número de equipos:</label>
            <select id="num-equipos" class="btn btn-secondary">
              <option value="2">2 Equipos</option>
              <option value="3">3 Equipos</option>
              <option value="4">4 Equipos</option>
              <option value="5">5 Equipos</option>
              <option value="6">6 Equipos</option>
            </select>
          </div>
          
          <div class="select-container" style="margin-top: 15px;">
            <label for="puntos-ganar">Puntos para ganar:</label>
            <input type="number" id="puntos-ganar" class="btn btn-secondary" value="40" min="5" max="100">
          </div>
          
          <div id="equipos-inputs" class="equipos-inputs">
            <div class="team-input-container">
              <input type="text" id="equipo-1" placeholder="Nombre del Equipo 1" value="Equipo 1">
            </div>
            <div class="team-input-container">
              <input type="text" id="equipo-2" placeholder="Nombre del Equipo 2" value="Equipo 2">
            </div>
          </div>
          
          <button id="start-game" class="btn btn-primary">¡Comenzar Juego!</button>
        </div>
      </div>
      
      <!-- Tablero de juego -->
      <div id="tablero" class="parchment">
        <h1 class="game-title" style="text-align: center;">Trivial de Física y Química</h1>
        
        <div class="teams-board" id="teams-board">
          <!-- Los equipos se generarán dinámicamente -->
        </div>
        
        <div id="dado-container">
          <h2>Tira el dado para determinar la dificultad</h2>
          <br>
          <br>
          <br>
          <div id="dado">
            <div class="cube">
              <div class="face front">1</div>
              <div class="face back">6</div>
              <div class="face right">3</div>
              <div class="face left">4</div>
              <div class="face top">5</div>
              <div class="face bottom">2</div>
            </div>
          </div>
          <br>
          <br>
          <p id="dado-resultado"></p>
          <br>
          <button id="tirar-dado" class="btn btn-primary">Tirar Dado</button>
        </div>
        
        <!-- Contenedor de la pregunta -->
        <div id="pregunta-container">
          <h2 id="pregunta-dificultad">Pregunta</h2>
          <p id="pregunta-texto"></p>
          <div id="respuestas-container">
            <!-- Las respuestas se generarán dinámicamente -->
          </div>
        </div>
      </div>
      
      <!-- Modal de resultado -->
      <div id="resultado-modal">
        <div class="modal-content">
          <h2 id="resultado-titulo"></h2>
          <div id="respuesta-correcta"></div>
          <button id="siguiente-turno" class="btn btn-primary">Siguiente Turno</button>
        </div>
      </div>
      
      <!-- Panel de Profesor -->
      <div id="profesor-panel-trigger">
        <i class="fas fa-chalkboard-teacher"></i>
      </div>
      
      <div id="profesor-panel">
        <button class="prof-close-btn"><i class="fas fa-times"></i></button>
        <h3>Panel del Profesor</h3>
        <div id="profesor-controls">
          <!-- Los controles se generarán dinámicamente -->
        </div>
      </div>
      
      <div id="sparkles-container"></div>
    </div>

    <script id="app-script">
      // Datos del juego
      const gameState = {
        equipos: [],
        equipoActivo: 0,
        ronda: 0,
        dadoResultado: null,
        preguntaActual: null,
        respuestaCorrecta: null,
        winPoints: 40
      };
      
      // Efectos del dado
      const efectosDado = [
        { nombre: "Fácil", puntos: 1 },
        { nombre: "Normal", puntos: 3 },
        { nombre: "Difícil", puntos: 5 },
        { nombre: "Robo", puntos: 1 },
        { nombre: "Doble o Nada", puntos: 5 },
        { nombre: "Fácil", puntos: 1 }
      ];
      
      // Banco de preguntas simulado
const bancoPreguntas = {
  facil: [
    { 
      pregunta: "¿Qué estudia la Física?", 
      respuestas: ["La constitución interna de la materia", "Los planetas", "Los cambios sin alterar la naturaleza interna", "La escritura"], 
      correcta: 2 
    },
    { 
      pregunta: "¿Qué estudia la Química?", 
      respuestas: ["El movimiento rectilíneo", "Las matemáticas", "Los cambios de posición", "Los cambios que afectan la naturaleza interna"], 
      correcta: 3 
    },
    { 
      pregunta: "La evaporación del agua es un cambio...", 
      respuestas: ["Nuclear", "Electromagnético", "Físico", "Químico"], 
      correcta: 2 
    },
    { 
      pregunta: "La oxidación del hierro es un cambio...", 
      respuestas: ["Químico", "Mecánico", "Magnético", "Físico"], 
      correcta: 0 
    },
    { 
      pregunta: "Lanzar una pelota es un cambio...", 
      respuestas: ["Eléctrico", "Químico", "Físico", "Nuclear"], 
      correcta: 2 
    },
    { 
      pregunta: "La fermentación del mosto en vino es un cambio...", 
      respuestas: ["Magnético", "Físico", "Químico", "Solar"], 
      correcta: 2 
    },
    { 
      pregunta: "Primer paso del método científico", 
      respuestas: ["Hipótesis", "Observación", "Conclusión", "Experimentación"], 
      correcta: 1 
    },
    { 
      pregunta: "Segundo paso del método científico", 
      respuestas: ["Conclusión", "Comunicar resultados", "Formulación de hipótesis", "Observación"], 
      correcta: 2 
    },
    { 
      pregunta: "Tercer paso del método científico", 
      respuestas: ["Hipótesis", "Experimentación", "Observación", "Ley científica"], 
      correcta: 1 
    },
    { 
      pregunta: "Último paso del método científico", 
      respuestas: ["Conclusión", "Ley científica", "Comunicación de resultados", "Experimentación"], 
      correcta: 2 
    },
    { 
      pregunta: "¿Qué representa el eje X en una gráfica?", 
      respuestas: ["Constante", "Variable dependiente", "Variable independiente", "Tiempo en segundos"], 
      correcta: 2 
    },
    { 
      pregunta: "¿Qué representa el eje Y en una gráfica?", 
      respuestas: ["Temperatura", "Variable dependiente", "Variable independiente", "Constante"], 
      correcta: 1 
    },
    { 
      pregunta: "Si al aumentar X también aumenta Y, es relación...", 
      respuestas: ["Constante", "Directa", "Inversa", "Cuadrática"], 
      correcta: 1 
    },
    { 
      pregunta: "Si al aumentar X disminuye Y, es relación...", 
      respuestas: ["Aleatoria", "Inversa", "Directa", "Constante"], 
      correcta: 1 
    },
    { 
      pregunta: "La Ley de Boyle relaciona...", 
      respuestas: ["Fuerza y distancia", "Masa y energía", "Presión y volumen", "Tiempo y velocidad"], 
      correcta: 2 
    },
    { 
      pregunta: "Fórmula de la Ley de Boyle", 
      respuestas: ["F=m·a", "V=d/t", "E=m·c²", "V·P=k"], 
      correcta: 3 
    },
    { 
      pregunta: "La fuerza se mide en...", 
      respuestas: ["Joule", "Watt", "Pascal", "Newton"], 
      correcta: 3 
    },
    { 
      pregunta: "La energía se mide en...", 
      respuestas: ["Kelvin", "Joule", "Pascal", "Newton"], 
      correcta: 1 
    },
    { 
      pregunta: "La presión se mide en...", 
      respuestas: ["Newton", "Pascal", "Watt", "Metro"], 
      correcta: 1 
    },
    { 
      pregunta: "La potencia se mide en...", 
      respuestas: ["Kelvin", "Joule", "Newton", "Watt"], 
      correcta: 3 
    },
  { 
    pregunta: "¿Cuál es la unidad de masa en el Sistema Internacional?", 
    respuestas: ["Metro", "Kilogramo", "Segundo", "Mol"], 
    correcta: 1 
  },
  { 
    pregunta: "¿Cuál es la unidad de longitud en el SI?", 
    respuestas: ["Candela", "Mol", "Metro", "Amperio"], 
    correcta: 2 
  },
  { 
    pregunta: "¿Qué magnitud se mide en segundos?", 
    respuestas: ["Tiempo", "Temperatura", "Masa", "Longitud"], 
    correcta: 0 
  },
  { 
    pregunta: "La temperatura se mide en qué unidad en el SI?", 
    respuestas: ["Metro", "Kelvin", "Segundo", "Amperio"], 
    correcta: 1 
  },
  { 
    pregunta: "¿Qué representa el amperio?", 
    respuestas: ["Masa", "Intensidad de corriente", "Longitud", "Tiempo"], 
    correcta: 1 
  },
  { 
    pregunta: "¿Qué representa la candela?", 
    respuestas: ["Tiempo", "Intensidad luminosa", "Temperatura", "Corriente"], 
    correcta: 1 
  },
  { 
    pregunta: "¿Qué magnitudes fundamentales conoces?", 
    respuestas: ["Color, sabor, olor", "Masa, longitud, tiempo, temperatura, sustancia, corriente, luz", "Velocidad, aceleración, fuerza", "Peso, energía, presión"], 
    correcta: 1 
  },
  { 
    pregunta: "El kilogramo mide:", 
    respuestas: ["Longitud", "Masa", "Tiempo", "Temperatura"], 
    correcta: 1 
  },
  { 
    pregunta: "El metro mide:", 
    respuestas: ["Tiempo", "Masa", "Temperatura", "Distancia"], 
    correcta: 3 
  },
  { 
    pregunta: "El segundo es unidad de:", 
    respuestas: ["Masa", "Tiempo", "Longitud", "Corriente"], 
    correcta: 1 
  },
  { 
    pregunta: "¿De qué están formadas todas las sustancias?", 
    respuestas: ["Electrones", "Neutrones", "Moléculas de agua", "Átomos"], 
    correcta: 3 
  },
  { 
    pregunta: "¿Cómo se llamaba la partícula indivisible según Demócrito?", 
    respuestas: ["Electrón", "Molécula", "Neutrón", "Átomo"], 
    correcta: 3 
  },
  { 
    pregunta: "¿Qué teoría propuso Aristóteles sobre la materia?", 
    respuestas: ["Teoría atómica", "Electrones girando", "Cuatro elementos", "Protones neutros"], 
    correcta: 2 
  },
  { 
    pregunta: "¿Quién propuso la teoría atómica moderna?", 
    respuestas: ["Dalton", "Bohr", "Rutherford", "Demócrito"], 
    correcta: 0 
  },
  { 
    pregunta: "¿Qué define un átomo de un elemento?", 
    respuestas: ["Número de neutrones", "Número de protones", "Número de electrones", "Número de capas"], 
    correcta: 1 
  },
  { 
    pregunta: "¿Un átomo tiene masa y volumen?", 
    respuestas: ["Solo masa", "Sí", "No", "Solo volumen"], 
    correcta: 1 
  },
  { 
    pregunta: "Todos los átomos de un elemento son iguales según Dalton:", 
    respuestas: ["Depende del isótopo", "Verdadero", "Falso", "Solo en laboratorio"], 
    correcta: 1 
  },
  { 
    pregunta: "Un átomo puede dividirse según Demócrito:", 
    respuestas: ["Sí", "No", "Solo algunos", "Depende del elemento"], 
    correcta: 1 
  },
  { 
    pregunta: "¿Qué es un modelo atómico?", 
    respuestas: ["Molécula de agua", "Representación de un átomo", "Elemento químico", "Partícula subatómica"], 
    correcta: 1 
  },
  { 
    pregunta: "Los átomos se combinan para formar:", 
    respuestas: ["Electrones", "Neutrones", "Moléculas", "Protones"], 
    correcta: 2 
  },
  { 
    pregunta: "¿Qué carga tiene el protón?", 
    respuestas: ["Negativa", "Positiva", "Neutra", "Variable"], 
    correcta: 1 
  },
  { 
    pregunta: "¿Qué carga tiene el electrón?", 
    respuestas: ["Positiva", "Negativa", "Neutra", "Variable"], 
    correcta: 1 
  },
  { 
    pregunta: "El neutrón tiene carga:", 
    respuestas: ["Neutra", "Positiva", "Negativa", "Variable"], 
    correcta: 0 
  },
  { 
    pregunta: "Cuál es la partícula más ligera del átomo:", 
    respuestas: ["Neutrón", "Molécula", "Electrón", "Protón"], 
    correcta: 2 
  },
  { 
    pregunta: "Qué partículas se encuentran en el núcleo:", 
    respuestas: ["Electrones y neutrones", "Protones y neutrones", "Electrones y protones", "Solo neutrones"], 
    correcta: 1 
  }
],

  normal: [
    { 
      pregunta: "¿Qué variable se manipula en un experimento?", 
      respuestas: ["Dependiente", "Constante", "Independiente", "Aleatoria"], 
      correcta: 2 
    },
    { 
      pregunta: "¿Qué variable se mide en un experimento?", 
      respuestas: ["Dependiente", "Independiente", "Constante", "Neutra"], 
      correcta: 0 
    },
    { 
      pregunta: "Si cultivo 10 plantas al sol y 10 en la sombra, ¿qué es la luz del sol?", 
      respuestas: ["Variable independiente", "Variable dependiente", "Constante", "Hipótesis"], 
      correcta: 0 
    },
    { 
      pregunta: "Si cultivo 10 plantas al sol y 10 en la sombra, ¿qué es la longitud de la planta?", 
      respuestas: ["Variable independiente", "Hipótesis", "Constante", "Variable dependiente"], 
      correcta: 3 
    },
    { 
      pregunta: "En un experimento, la cantidad de agua que reciben las plantas es...", 
      respuestas: ["Constante", "Variable independiente", "Variable dependiente", "Error"], 
      correcta: 0 
    },
    { 
      pregunta: "Si una gráfica muestra Y creciendo linealmente con X, es...", 
      respuestas: ["Proporcionalidad directa", "Relación inversa", "Constante", "Parábola"], 
      correcta: 0 
    },
    { 
      pregunta: "La fórmula F=m·g calcula...", 
      respuestas: ["Trabajo", "Energía", "Peso", "Velocidad"], 
      correcta: 2 
    },
    { 
      pregunta: "Un objeto de 5 kg en la Tierra (g=10) pesa...", 
      respuestas: ["500 N", "10 N", "5 N", "50 N"], 
      correcta: 3 
    },
    { 
      pregunta: "Si F=10 N y d=5 m, el trabajo es...", 
      respuestas: ["50 J", "15 J", "2 J", "5 J"], 
      correcta: 0 
    },
    { 
      pregunta: "Si m=2 kg, v=3 m/s, la energía cinética es...", 
      respuestas: ["3 J", "12 J", "6 J", "9 J"], 
      correcta: 3 
    },
  { 
    pregunta: "¿Qué modelo atómico explica los espectros de emisión?", 
    respuestas: ["Modelo de Dalton", "Modelo de Rutherford", "Modelo de Bohr", "Modelo de Aristóteles"], 
    correcta: 2 
  },
  { 
    pregunta: "El número de neutrones en un átomo se obtiene restando:", 
    respuestas: ["A-Z", "Z-A", "A+Z", "Z+N"], 
    correcta: 0 
  },
  { 
    pregunta: "Los isótopos de un mismo elemento tienen:", 
    respuestas: ["Igual número de protones", "Igual número de neutrones", "Igual número másico", "Igual número de electrones"], 
    correcta: 0 
  },
  { 
    pregunta: "La masa atómica de un elemento es un promedio de:", 
    respuestas: ["Protones y neutrones", "Electrones y protones", "Isótopos según su abundancia", "Número atómico"], 
    correcta: 2 
  },
  { 
    pregunta: "Cuántos electrones caben en un subnivel p:", 
    respuestas: ["2", "6", "10", "14"], 
    correcta: 1 
  },
  { 
    pregunta: "Cuántos electrones caben en un subnivel d:", 
    respuestas: ["2", "6", "10", "14"], 
    correcta: 2 
  },
  { 
    pregunta: "Cuántos electrones caben en un subnivel f:", 
    respuestas: ["2", "6", "10", "14"], 
    correcta: 3 
  },
  { 
    pregunta: "El catión más común de sodio es:", 
    respuestas: ["Na⁻", "Na⁺", "Cl⁻", "K⁺"], 
    correcta: 1 
  },
  { 
    pregunta: "El anión más común de cloro es:", 
    respuestas: ["Cl⁺", "Cl⁻", "O²⁻", "S²⁻"], 
    correcta: 1 
  },
  { 
    pregunta: "El número atómico de un elemento indica:", 
    respuestas: ["Número de electrones en la capa de valencia", "Número de protones en el núcleo", "Número de neutrones", "Número másico"], 
    correcta: 1 
  },
  { 
    pregunta: "El número másico indica:", 
    respuestas: ["Número de protones", "Número de electrones", "Suma de protones y neutrones", "Suma de electrones y neutrones"], 
    correcta: 2 
  },
  { 
    pregunta: "Los átomos tienden a cumplir la regla del octete para:", 
    respuestas: ["Ser estables", "Ser neutros", "Ganar protones", "Perder neutrones"], 
    correcta: 0 
  },
  { 
    pregunta: "La capa de valencia determina:", 
    respuestas: ["La masa del átomo", "La reactividad química", "El número de neutrones", "El número másico"], 
    correcta: 1 
  },
  { 
    pregunta: "Un catión se forma cuando un átomo:", 
    respuestas: ["Gana electrones", "Pierde electrones", "Gana protones", "Pierde neutrones"], 
    correcta: 1 
  },
  { 
    pregunta: "Un anión se forma cuando un átomo:", 
    respuestas: ["Gana electrones", "Pierde electrones", "Gana protones", "Pierde neutrones"], 
    correcta: 0 
  },
  { 
    pregunta: "La notación electrónica 1s² 2s² 2p⁶ indica:", 
    respuestas: ["Distribución de protones", "Distribución de neutrones", "Distribución de electrones", "Número atómico"], 
    correcta: 2 
  },
  { 
    pregunta: "Según Bohr, los electrones solo pueden:", 
    respuestas: ["Estar en cualquier órbita", "Estar en órbitas cuantizadas", "Estar en el núcleo", "No existir"], 
    correcta: 1 
  },
  { 
    pregunta: "Rutherford propuso que el núcleo es:", 
    respuestas: ["Negativo y pequeño", "Positivo y pequeño", "Negativo y grande", "Positivo y grande"], 
    correcta: 1 
  },
  { 
    pregunta: "Qué partículas forman el núcleo de un átomo:", 
    respuestas: ["Electrones y protones", "Protones y neutrones", "Electrones y neutrones", "Neutrones y electrones"], 
    correcta: 1 
  },
  { 
    pregunta: "Qué partículas giran alrededor del núcleo:", 
    respuestas: ["Protones", "Neutrones", "Electrones", "Moléculas"], 
    correcta: 2 
  },
  { 
    pregunta: "Los aniones suelen formarse a partir de:", 
    respuestas: ["Metales", "No metales", "Gases nobles", "Isótopos"], 
    correcta: 1 
  },
  { 
    pregunta: "Los cationes suelen formarse a partir de:", 
    respuestas: ["Metales", "No metales", "Gases nobles", "Isótopos"], 
    correcta: 0 
  },
  { 
    pregunta: "El oxígeno forma con los metales:", 
    respuestas: ["Hidruros", "Óxidos", "Cationes", "Aniones"], 
    correcta: 1 
  },
  { 
    pregunta: "El hidrógeno puede formar:", 
    respuestas: ["Óxidos", "Hidruros", "Aniones", "Cationes"], 
    correcta: 1 
  },
  { 
    pregunta: "Los electrones de valencia se encuentran en:", 
    respuestas: ["Capa más interna", "Capa de valencia", "Núcleo", "Subnivel d"], 
    correcta: 1 
  }
],


  dificil: [
    { 
      pregunta: "Si una planta al sol crece 15 cm y otra a la sombra 5 cm, ¿qué variable es la diferencia de altura?", 
      respuestas: ["Constante", "Error", "Dependiente", "Independiente"], 
      correcta: 2 
    },
    { 
      pregunta: "Si duplicamos la distancia entre dos masas, la fuerza de atracción gravitatoria...", 
      respuestas: ["Se mantiene", "Se reduce a la mitad", "Se duplica", "Se reduce a la cuarta parte"], 
      correcta: 3 
    },
    { 
      pregunta: "Un gas ocupa 4 L a 2 atm. Según Boyle, si aumenta la presión a 4 atm, el volumen será...", 
      respuestas: ["4 L", "1 L", "2 L", "8 L"], 
      correcta: 2 
    },
    { 
      pregunta: "Un coche de 1000 kg a 20 m/s tiene energía cinética de...", 
      respuestas: ["10000 J", "400000 J", "200000 J", "20000 J"], 
      correcta: 2 
    },
    { 
      pregunta: "Una caja de 50 kg a 2 m de altura tiene energía potencial de...", 
      respuestas: ["50 J", "200 J", "500 J", "1000 J"], 
      correcta: 3 
    },
    { 
      pregunta: "Si aplico 20 N y el objeto no se mueve, el trabajo es...", 
      respuestas: ["No se puede calcular", "0", "20 J", "Cero"], 
      correcta: 3 
    },
    { 
      pregunta: "Una fuerza de 10 N desplaza un objeto 3 m en contra de la dirección del movimiento. El trabajo es...", 
      respuestas: ["30 J", "10 J", "0", "-30 J"], 
      correcta: 3 
    },
    { 
      pregunta: "Un objeto recorre 100 m en 20 s. Su velocidad media es...", 
      respuestas: ["5 m/s", "10 m/s", "2 m/s", "4 m/s"], 
      correcta: 0 
    },
    { 
      pregunta: "Un coche pasa de 0 a 20 m/s en 10 s. Su aceleración es...", 
      respuestas: ["5 m/s²", "2 m/s²", "1 m/s²", "10 m/s²"], 
      correcta: 1 
    },
    { 
      pregunta: "Si un bloque pesa 200 N y el área de apoyo es 0,5 m², la presión ejercida es...", 
      respuestas: ["200 Pa", "100 Pa", "600 Pa", "400 Pa"], 
      correcta: 3 
    }
  ]
};

      
      // Eventos DOM
      document.addEventListener('DOMContentLoaded', function() {
        // Configuración inicial
        cargarJuegoGuardado();
        actualizarFormularioEquipos();
        
        // Evento para cambiar el número de equipos
        document.getElementById('num-equipos').addEventListener('change', actualizarFormularioEquipos);
        
        // Evento para iniciar el juego
        document.getElementById('start-game').addEventListener('click', iniciarJuego);
        
        // Evento para tirar el dado
        document.getElementById('tirar-dado').addEventListener('click', tirarDado);
        
        // Evento para continuar al siguiente turno
        document.getElementById('siguiente-turno').addEventListener('click', siguienteTurno);
        
        // Eventos del panel profesor
        document.getElementById('profesor-panel-trigger').addEventListener('click', function() {
            document.getElementById('profesor-panel').classList.add('show');
        });
        
        // Add event listener for close button
        document.querySelector('.prof-close-btn').addEventListener('click', function() {
            document.getElementById('profesor-panel').classList.remove('show');
        });
      });
      
      // Función para actualizar el formulario según el número de equipos seleccionado
      function actualizarFormularioEquipos() {
        const numEquipos = parseInt(document.getElementById('num-equipos').value);
        const equiposInputs = document.getElementById('equipos-inputs');
        
        // Limpiar inputs actuales
        equiposInputs.innerHTML = '';
        
        // Crear inputs según el número seleccionado
        for (let i = 1; i <= numEquipos; i++) {
          const inputContainer = document.createElement('div');
          inputContainer.className = 'team-input-container';
          
          const input = document.createElement('input');
          input.type = 'text';
          input.id = `equipo-${i}`;
          input.placeholder = `Nombre del Equipo ${i}`;
          input.value = `Equipo ${i}`;
          
          inputContainer.appendChild(input);
          equiposInputs.appendChild(inputContainer);
        }
      }
      
      // Función para iniciar el juego
      function iniciarJuego() {
        const numEquipos = parseInt(document.getElementById('num-equipos').value);
        gameState.equipos = [];
        
        // Obtener puntos para ganar
        const puntosInput = document.getElementById('puntos-ganar');
        gameState.winPoints = puntosInput ? parseInt(puntosInput.value) : 40;
        
        // Recoger nombres de equipos
        for (let i = 1; i <= numEquipos; i++) {
          const nombreEquipo = document.getElementById(`equipo-${i}`).value.trim() || `Equipo ${i}`;
          gameState.equipos.push({
            nombre: nombreEquipo,
            puntuacion: 0
          });
        }
        
        // Iniciar primera ronda
        gameState.equipoActivo = 0;
        gameState.ronda = 1;
        
        // Guardar estado inicial
        guardarEstadoJuego();
        
        // Cambiar a vista de tablero
        document.getElementById('inicio').style.display = 'none';
        document.getElementById('tablero').style.display = 'block';
        
        // Renderizar tablero
        actualizarTablero();
      }
      
      // Función para actualizar el tablero
      function actualizarTablero() {
        const teamsBoard = document.getElementById('teams-board');
        teamsBoard.innerHTML = '';
        
        // Crear tarjeta para cada equipo
        gameState.equipos.forEach((equipo, index) => {
          const teamCard = document.createElement('div');
          teamCard.className = `team-card ${index === gameState.equipoActivo ? 'active' : ''}`;
          
          const teamName = document.createElement('div');
          teamName.className = 'team-name';
          teamName.textContent = equipo.nombre;
          
          const teamScore = document.createElement('div');
          teamScore.className = 'team-score';
          teamScore.textContent = equipo.puntuacion;
          
          teamCard.appendChild(teamName);
          teamCard.appendChild(teamScore);
          teamsBoard.appendChild(teamCard);
        });
        
        // Actualizar panel del profesor
        actualizarPanelProfesor();
      }
      
      // Función para tirar el dado
      function tirarDado() {
        const dado = document.getElementById('dado');
        const cube = dado.querySelector('.cube');
        const dadoResultadoText = document.getElementById('dado-resultado');
        const tirarBtn = document.getElementById('tirar-dado');
        
        // Deshabilitar botón mientras se tira
        tirarBtn.disabled = true;
        
        // Clear previous result
        dadoResultadoText.textContent = '';
        
        // Call 3D spin animation
        spinDice().then((resultadoIndex) => {
          gameState.dadoResultado = efectosDado[resultadoIndex];
          
          // Mostrar resultado con animación
          dadoResultadoText.textContent = `¡${gameState.dadoResultado.nombre}!`;
          dadoResultadoText.classList.add('animate__animated', 'animate__bounceIn');
          
          // Limpiar animación después
          setTimeout(() => {
            dadoResultadoText.classList.remove('animate__animated', 'animate__bounceIn');
          }, 1000);
          
          // Después de mostrar el resultado, mostrar la pregunta
          setTimeout(mostrarPregunta, 1000);
        });
      }

      // New function to handle 3D dice animation
      function spinDice() {
        return new Promise((resolve) => {
          const cube = document.querySelector('.cube');
          
          // Generate random rotations (ensure it rotates at least twice)
          const rotX = 360 * (2 + Math.floor(Math.random() * 3)) + Math.floor(Math.random() * 4) * 90;
          const rotY = 360 * (2 + Math.floor(Math.random() * 3)) + Math.floor(Math.random() * 4) * 90;
          const rotZ = Math.floor(Math.random() * 360);
          
          // Apply the rotation
          cube.style.transform = `rotateX(${rotX}deg) rotateY(${rotY}deg) rotateZ(${rotZ}deg)`;
          
          // Determine which face is shown at the end
          setTimeout(() => {
            // Calculate which face is shown based on the final rotation
            let resultadoIndex = 0;
            
            // Simplified calculation based on final rotation angles
            const xMod = ((rotX % 360) + 360) % 360;
            const yMod = ((rotY % 360) + 360) % 360;
            
            // Determine which face is on top based on rotation
            if (xMod < 45 || xMod > 315) {
              // Front face = 0 (Fácil - 1)
              resultadoIndex = 0;
            } else if (xMod >= 45 && xMod < 135) {
              // Top face = 4 (Difícil - 5)
              resultadoIndex = 4;
            } else if (xMod >= 135 && xMod < 225) {
              // Back face = 1 (Doble o Nada - 6)
              resultadoIndex = 5;
            } else if (xMod >= 225 && xMod < 315) {
              // Bottom face = 5 (Normal - 2)
              resultadoIndex = 1;
            }
            
            // Further adjust based on y rotation
            if ((yMod >= 45 && yMod < 135) || (yMod >= 225 && yMod < 315)) {
              // Left or right face (Robo - 4 or Fácil - 3)
              resultadoIndex = yMod < 180 ? 2 : 3;
            }
            
            resolve(resultadoIndex);
          }, 1500);
        });
      }
      
      // Función para mostrar pregunta
      function mostrarPregunta() {
        const preguntaContainer = document.getElementById('pregunta-container');
        const preguntaDificultad = document.getElementById('pregunta-dificultad');
        const preguntaTexto = document.getElementById('pregunta-texto');
        const respuestasContainer = document.getElementById('respuestas-container');
        
        // Reset any previous style changes
        preguntaContainer.style.display = 'none';
        preguntaContainer.classList.remove('show', 'animate__animated', 'animate__fadeIn');
        
        // Determinar la dificultad según el dado
        let dificultad;
        switch (gameState.dadoResultado.nombre) {
          case "Fácil":
            dificultad = 'facil';
            break;
          case "Normal":
            dificultad = 'normal';
            break;
          case "Difícil":
          case "Robo":
          case "Doble o Nada":
            dificultad = 'dificil';
            break;
          default:
            dificultad = 'normal';
        }
        
        // Obtener pregunta aleatoria
        const preguntasPosibles = bancoPreguntas[dificultad];
        const preguntaIndex = Math.floor(Math.random() * preguntasPosibles.length);
        gameState.preguntaActual = preguntasPosibles[preguntaIndex];
        gameState.respuestaCorrecta = gameState.preguntaActual.correcta;
        
        // Configurar contenido
        preguntaDificultad.textContent = `Pregunta ${dificultad.toUpperCase()}`;
        preguntaTexto.textContent = gameState.preguntaActual.pregunta;
        respuestasContainer.innerHTML = '';
        
        // Crear botones de respuesta
        gameState.preguntaActual.respuestas.forEach((respuesta, index) => {
          const btn = document.createElement('button');
          btn.className = 'respuesta-btn';
          btn.textContent = respuesta;
          btn.addEventListener('click', () => verificarRespuesta(index));
          
          respuestasContainer.appendChild(btn);
        });
        
        // Mostrar contenedor con animación
        preguntaContainer.style.display = 'block';
        preguntaContainer.classList.add('animate__animated', 'animate__fadeIn');
        
        setTimeout(() => {
          preguntaContainer.classList.add('show');
        }, 50);
      }
      
      // Verificar respuesta
      function verificarRespuesta(respuestaIndex) {
        const esCorrecta = respuestaIndex === gameState.respuestaCorrecta;
        const equipoActual = gameState.equipos[gameState.equipoActivo];
        let mensaje = '';
        let puntosGanados = 0;
        
        // Get UI elements for animation
        const teamCards = document.querySelectorAll('.team-card');
        const activeTeamCard = teamCards[gameState.equipoActivo];
        const respuestaBtns = document.querySelectorAll('.respuesta-btn');
        const preguntaContainer = document.getElementById('pregunta-container');
        
        // Apply animations based on correct/incorrect
        if (esCorrecta) {
          // Green flash animation for team card
          activeTeamCard.style.animation = 'greenFlash 1s';
          
          // Highlight the correct answer button
          respuestaBtns[respuestaIndex].classList.add('thumbs-up');
          respuestaBtns[respuestaIndex].style.backgroundColor = 'rgba(76, 175, 80, 0.3)';
          
          // Add sparkle effect
          createSparkles();
          
          // Calculate points
          switch (gameState.dadoResultado.nombre) {
            case "Robo":
              // Uso de async/await para manejar la promesa
              mostrarSelectorRobo().then(puntos => {
                puntosGanados = puntos;
                equipoActual.puntuacion += puntosGanados;
                
                // Guardar estado actualizado
                guardarEstadoJuego();
                
                // Verificar si hay un ganador
                verificarGanador(equipoActual);
                
                // Mostrar modal con resultado
                mostrarResultado(esCorrecta, `¡Correcto! Robaste ${puntosGanados} punto`);
              });
              return; // Salimos temprano ya que la promesa manejará el resto
            case "Doble o Nada":
              puntosGanados = gameState.dadoResultado.puntos;
              mensaje = `¡Correcto! Ganas ${puntosGanados} puntos`;
              break;
            default:
              puntosGanados = gameState.dadoResultado.puntos;
              mensaje = `¡Correcto! Ganas ${puntosGanados} puntos`;
          }
          equipoActual.puntuacion += puntosGanados;
        } else {
          // Red shake animation for question container
          preguntaContainer.style.animation = 'redShake 0.5s';
          
          // Highlight correct answer
          respuestaBtns[gameState.respuestaCorrecta].style.backgroundColor = 'rgba(76, 175, 80, 0.3)';
          respuestaBtns[respuestaIndex].style.backgroundColor = 'rgba(244, 67, 54, 0.3)';
          
          if (gameState.dadoResultado.nombre === "Doble o Nada") {
            // Perder exactamente 2 puntos si es "Doble o Nada" y falla
            equipoActual.puntuacion -= 2;
            mensaje = "¡Incorrecto! Pierdes 2 puntos";
          } else {
            mensaje = "¡Incorrecto!";
          }
        }
        
        // Reset animations after delay
        setTimeout(() => {
          if (activeTeamCard) activeTeamCard.style.animation = '';
          if (preguntaContainer) preguntaContainer.style.animation = '';
          respuestaBtns.forEach(btn => {
            btn.classList.remove('thumbs-up');
          });
        }, 1000);
        
        // Guardar estado actualizado
        guardarEstadoJuego();
        
        // Verificar si hay un ganador
        verificarGanador(equipoActual);
        
        // Mostrar modal con resultado
        mostrarResultado(esCorrecta, mensaje);
      }

      // Function to create sparkle effect
      function createSparkles() {
        const sparklesContainer = document.getElementById('sparkles-container');
        
        // Create 30 sparkles
        for (let i = 0; i < 30; i++) {
          const sparkle = document.createElement('div');
          sparkle.className = 'sparkle';
          
          // Random position
          const x = Math.random() * window.innerWidth;
          const y = window.innerHeight - Math.random() * 200;
          
          // Set position
          sparkle.style.left = `${x}px`;
          sparkle.style.top = `${y}px`;
          
          // Random delay
          sparkle.style.animationDelay = `${Math.random() * 1.5}s`;
          
          // Append to container
          sparklesContainer.appendChild(sparkle);
          
          // Remove after animation
          setTimeout(() => {
            sparkle.remove();
          }, 3000);
        }
      }
      
      // Nueva función para manejar el robo con selector
      function mostrarSelectorRobo() {
        return new Promise((resolve) => {
          // Crear modal para selección
          const modal = document.createElement('div');
          modal.style.position = 'fixed';
          modal.style.top = '0';
          modal.style.left = '0';
          modal.style.right = '0';
          modal.style.bottom = '0';
          modal.style.backgroundColor = 'rgba(0, 0, 0, 0.7)';
          modal.style.display = 'flex';
          modal.style.justifyContent = 'center';
          modal.style.alignItems = 'center';
          modal.style.zIndex = '2000';
          
          const content = document.createElement('div');
          content.className = 'modal-content';
          content.innerHTML = '<h3>Selecciona un equipo para robarle 1 punto</h3>';
          
          // Crear selector con todos los equipos excepto el actual
          const selector = document.createElement('select');
          selector.className = 'btn btn-secondary';
          selector.style.margin = '20px 0';
          selector.style.width = '100%';
          
          let hayOtrosEquipos = false;
          
          // Añadir equipos que no son el actual (sin filtrar por puntuación)
          gameState.equipos.forEach((equipo, index) => {
            if (index !== gameState.equipoActivo) {
              const option = document.createElement('option');
              option.value = index;
              option.textContent = `${equipo.nombre} (${equipo.puntuacion} pts)`;
              selector.appendChild(option);
              hayOtrosEquipos = true;
            }
          });
          
          // Si no hay otros equipos, dar punto sin robar
          if (!hayOtrosEquipos) {
            document.body.removeChild(modal);
            resolve(1); // Dar 1 punto sin robar
            return;
          }
          
          content.appendChild(selector);
          
          const confirmBtn = document.createElement('button');
          confirmBtn.className = 'btn btn-primary';
          confirmBtn.textContent = 'Confirmar';
          content.appendChild(confirmBtn);
          
          modal.appendChild(content);
          document.body.appendChild(modal);
          
          confirmBtn.addEventListener('click', () => {
            const equipoVictima = parseInt(selector.value);
            gameState.equipos[equipoVictima].puntuacion--;
            document.body.removeChild(modal);
            
            // Actualizar tablero
            actualizarTablero();
            
            // Resolver promesa con puntos ganados
            resolve(1); // Siempre roba 1 punto
          });
        });
      }
      
      // Mostrar modal con resultado
      function mostrarResultado(esCorrecta, mensaje) {
        const modal = document.getElementById('resultado-modal');
        const titulo = document.getElementById('resultado-titulo');
        const respuestaCorrecta = document.getElementById('respuesta-correcta');
        
        // Configurar modal
        titulo.className = esCorrecta ? 'resultado-correcto' : 'resultado-incorrecto';
        titulo.textContent = mensaje;
        
        // Mostrar respuesta correcta
        respuestaCorrecta.textContent = `Respuesta correcta: ${gameState.preguntaActual.respuestas[gameState.respuestaCorrecta]}`;
        
        // Mostrar modal
        modal.style.display = 'flex';
      }
      
      // Función para pasar al siguiente turno
      function siguienteTurno() {
        // Cerrar modal
        document.getElementById('resultado-modal').style.display = 'none';
        
        // Fade out the question container with animation
        const preguntaContainer = document.getElementById('pregunta-container');
        preguntaContainer.classList.add('animate__animated', 'animate__fadeOut');
        
        setTimeout(() => {
          preguntaContainer.classList.remove('show', 'animate__animated', 'animate__fadeOut');
          preguntaContainer.style.display = 'none';
          
          // Pasar al siguiente equipo
          gameState.equipoActivo = (gameState.equipoActivo + 1) % gameState.equipos.length;
          if (gameState.equipoActivo === 0) {
            gameState.ronda++;
          }
          
          // Resetear estado del dado
          document.getElementById('tirar-dado').disabled = false;
          document.getElementById('dado-resultado').textContent = '';
          
          // Reset cube to neutral position
          const cube = document.querySelector('.cube');
          cube.style.transform = 'rotateX(0deg) rotateY(0deg) rotateZ(0deg)';
          
          // Actualizar tablero
          actualizarTablero();
        }, 500);
      }
      
      // Función para actualizar el panel del profesor
      function actualizarPanelProfesor() {
        const profesorControls = document.getElementById('profesor-controls');
        profesorControls.innerHTML = '';
        
        // Crear controles para cada equipo
        gameState.equipos.forEach((equipo, index) => {
            const teamControl = document.createElement('div');
            teamControl.className = 'profesor-team-control';
            
            const teamName = document.createElement('div');
            teamName.className = 'prof-team-name';
            teamName.textContent = equipo.nombre + `: ${equipo.puntuacion} pts`;
            
            const buttonContainer = document.createElement('div');
            buttonContainer.className = 'prof-team-buttons';
            
            const minusBtn = document.createElement('button');
            minusBtn.className = 'btn btn-danger prof-btn';
            minusBtn.innerHTML = '<i class="fas fa-minus"></i> -1';
            minusBtn.addEventListener('click', () => {
                equipo.puntuacion--;
                guardarEstadoJuego();
                actualizarTablero();
            });
            
            const plusBtn = document.createElement('button');
            plusBtn.className = 'btn btn-primary prof-btn';
            plusBtn.innerHTML = '<i class="fas fa-plus"></i> +1';
            plusBtn.addEventListener('click', () => {
                equipo.puntuacion++;
                guardarEstadoJuego();
                actualizarTablero();
            });
            
            buttonContainer.appendChild(minusBtn);
            buttonContainer.appendChild(plusBtn);
            
            teamControl.appendChild(teamName);
            teamControl.appendChild(buttonContainer);
            
            profesorControls.appendChild(teamControl);
        });
      }
      
      // Guardar estado en localStorage
      function guardarEstadoJuego() {
        try {
          localStorage.setItem('trivialGameState', JSON.stringify(gameState));
        } catch (e) {
          console.error('Error al guardar estado del juego:', e);
        }
      }
      
      // Cargar estado desde localStorage
      function cargarJuegoGuardado() {
        try {
          const savedState = localStorage.getItem('trivialGameState');
          if (savedState) {
            const parsedState = JSON.parse(savedState);
            
            // Verificar que el estado guardado tiene la estructura esperada
            if (parsedState.equipos && Array.isArray(parsedState.equipos)) {
              // Podríamos implementar la recuperación del juego aquí
              // Por ahora, solo dejamos que empiece un juego nuevo
            }
          }
        } catch (e) {
          console.error('Error al cargar estado del juego:', e);
        }
      }
      
      // Nueva función para verificar si hay ganador
      function verificarGanador(equipo) {
        if (equipo.puntuacion >= gameState.winPoints) {
          // Fin del juego
          endGame();
        }
      }
      
      // Nueva función para finalizar el juego y mostrar clasificación
      function endGame() {
        // Ordenar equipos por puntuación (de mayor a menor)
        const equiposOrdenados = [...gameState.equipos].sort((a, b) => b.puntuacion - a.puntuacion);
        
        // Crear modal de clasificación final
        const modal = document.createElement('div');
        modal.id = 'clasificacion-modal';
        modal.style.position = 'fixed';
        modal.style.top = '0';
        modal.style.left = '0';
        modal.style.right = '0';
        modal.style.bottom = '0';
        modal.style.backgroundColor = 'rgba(0, 0, 0, 0.8)';
        modal.style.display = 'flex';
        modal.style.justifyContent = 'center';
        modal.style.alignItems = 'center';
        modal.style.zIndex = '3000';
        
        const content = document.createElement('div');
        content.className = 'parchment fade-in';
        content.style.maxWidth = '600px';
        content.style.width = '90%';
        
        const titulo = document.createElement('h1');
        titulo.textContent = '¡Fin del Juego!';
        titulo.style.textAlign = 'center';
        titulo.style.marginBottom = '20px';
        content.appendChild(titulo);
        
        const ganador = document.createElement('h2');
        ganador.innerHTML = `¡${equiposOrdenados[0].nombre} gana con ${equiposOrdenados[0].puntuacion} puntos!`;
        ganador.style.textAlign = 'center';
        ganador.style.marginBottom = '30px';
        ganador.style.color = 'var(--color-gold-dark)';
        content.appendChild(ganador);
        
        const clasificacionTitulo = document.createElement('h3');
        clasificacionTitulo.textContent = 'Clasificación Final';
        clasificacionTitulo.style.textAlign = 'center';
        clasificacionTitulo.style.marginBottom = '15px';
        content.appendChild(clasificacionTitulo);
        
        const clasificacionLista = document.createElement('ol');
        clasificacionLista.style.fontSize = '1.2rem';
        clasificacionLista.style.paddingLeft = '30px';
        
        equiposOrdenados.forEach(equipo => {
          const item = document.createElement('li');
          item.textContent = `${equipo.nombre}: ${equipo.puntuacion} puntos`;
          item.style.margin = '10px 0';
          clasificacionLista.appendChild(item);
        });
        
        content.appendChild(clasificacionLista);
        
        const newGameBtn = document.createElement('button');
        newGameBtn.className = 'btn btn-primary';
        newGameBtn.textContent = 'Jugar de Nuevo';
        newGameBtn.style.marginTop = '30px';
        newGameBtn.style.display = 'block';
        newGameBtn.style.margin = '30px auto 0';
        newGameBtn.addEventListener('click', () => {
          // Reiniciar juego
          localStorage.removeItem('trivialGameState');
          location.reload();
        });
        
        content.appendChild(newGameBtn);
        modal.appendChild(content);
        document.body.appendChild(modal);
      }
    </script>
  </body>
</html>
